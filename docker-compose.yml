# Docker Compose - RAG Chatbot System
# Web chatbot dan Qdrant dalam Docker
# AI Service dijalankan lokal (untuk akses ROCm GPU)

services:
  # Web Chatbot UI
  web:
    build: ./web-chatbot
    container_name: rag-web
    ports:
      - "8080:8000"
    environment:
      - QDRANT_HOST=qdrant
      - QDRANT_PORT=6333
      - QDRANT_COLLECTION=financial_data
      - AI_SERVICE_URL=http://host.docker.internal:8001
      - RAG_TOP_K=5
      - RAG_SCORE_THRESHOLD=0.0
    depends_on:
      - qdrant
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped

  # Qdrant Vector Database
  qdrant:
    image: qdrant/qdrant:latest
    container_name: rag-qdrant
    ports:
      - "6333:6333"
      - "6334:6334"
    volumes:
      - qdrant_data:/qdrant/storage
    restart: unless-stopped

volumes:
  qdrant_data:
